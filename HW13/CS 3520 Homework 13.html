<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- saved from url=(0045)https://pubweb.eng.utah.edu/~cs3520/hw13.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>CS 3520  Homework 13</title><link href="./CS 3520 Homework 13_files/css" rel="stylesheet"><style>td { vertical-align: baseline; } table, body, .mainfont { font-size: 18; }.schedule { font-size: 16; }body, .mainfont { font-family: 'Sorts Mill Goudy', serif; }h1, h2, h3, h4, h5, .head, .label { font-family: 'Titillium Web', sans-serif;  }.head { font-weight: bold; }a { text-decoration: none; }.highlight { font-style: italic; color: #000088 } </style></head><body style="bgcolor: white; width: 45em; margin-left: auto; margin-right: auto"><h2>CS 3520  Homework 13</h2><p class="label">Due: Friday, December 14th, 2018 11:59pm</p><p><i>Submit your work by <a href="https://docs.google.com/spreadsheets/d/1DPjiOFw3eMcSAOCHmwDeLX2NnDZqEnchWmOcw5PTsiA/edit?usp=sharing">scheduling a meeting with the instructor</a>, preferably at a time well before the due date. You’ll show your code and answer questions in the meeting. You don’t need to handin your code at all, other than showing it at the meeting.</i></p><p>Start with the typed-class interpreter and typechecker: <tt><a href="https://pubweb.eng.utah.edu/~cs3520/typed-parse.rkt">typed-parse.rkt</a></tt>. <tt><a href="https://pubweb.eng.utah.edu/~cs3520/typed-class.rkt">typed-class.rkt</a></tt>, <tt><a href="https://pubweb.eng.utah.edu/~cs3520/inherit.rkt">inherit.rkt</a></tt>. <tt><a href="https://pubweb.eng.utah.edu/~cs3520/inherit-parse.rkt">inherit-parse.rkt</a></tt>. and <tt><a href="https://pubweb.eng.utah.edu/~cs3520/class.rkt">class.rkt</a></tt>. Since you won’t use the “Handin” button to submit your work, there’s no need to collapse the modules into a single file.</p><p>Implement some of the follow additions, which are of varying difficulty. Each addition is annotated by a star rating; implement enough additions so that the sum of the star ratings is:</p><ul><li>CS 3520 students: at least 8 <font>★</font>s</li><li>CS 6520 students: at least 10 <font>★</font>s</li></ul><p>Extra credit will be awarded for rating sums beyond the required level, where the extra-point value of an extra star wll be 50% of the point value of a required star (e.g., 16 <font>★</font>s would be 150% for a CS 3520 student).</p><table><tbody><tr><td valign="top" align="right" class="mainfont"><font size="-2"><font>★</font></font>&nbsp;1.</td><td class="mainfont">Fix the type checker so that <tt>this</tt> and <tt>arg</tt> are prohibited in the main expression of a program (but allowed in a method body). <i>This option Cannot be combined with 9, since 9 easily subsumes this problem.</i></td></tr><tr><td valign="top" align="right" class="mainfont"><font size="-2"><font>★</font></font>&nbsp;2.</td><td class="mainfont">Add a <tt>{cast &lt;Symbol&gt; &lt;ExpI&gt;}</tt> form to the language. At run-time, the <tt>cast</tt> expression reports an error if <tt>&lt;ExpI&gt;</tt> does not produce an instance of <tt>&lt;Symbol&gt;</tt> or one of its subclasses. Otherwise, the result is just the result of <tt>&lt;ExpI&gt;</tt>. Of course, <tt>&lt;Symbol&gt;</tt> should generally be a subtype of the type for <tt>&lt;ExpI&gt;</tt>, and the type checker can assume that the <tt>{cast &lt;Symbol&gt; &lt;ExpI&gt;}</tt> has type <tt>&lt;Symbol&gt;</tt>. The type-checker must reject the expression if the type of <tt>&lt;ExpI&gt;</tt> is neither a subtype nor supertype of <tt>&lt;Symbol&gt;</tt>, since the cast cannot succeed in that case.</td></tr><tr><td valign="top" align="right" class="mainfont"><font size="-2"><font>★★</font></font>&nbsp;3.</td><td class="mainfont">Add an <tt>{if0 &lt;ExpI&gt; &lt;ExpI&gt; &lt;ExpI&gt;}</tt> form to the language,  where <tt>if0</tt> requires a number for the test expression. The “then” and “else” branches should both have a type that is a subtype of some most-specific third type: one that is a subtype of any supertype of both the “then” and “else” types, which you might call the “least upper bound” of the “then” and “else” types.</td></tr><tr><td valign="top" align="right" class="mainfont"><font size="-2"><font>★★</font></font>&nbsp;4.</td><td class="mainfont">Add a Java-style <tt>null</tt> expression and value to the language. A <tt>null</tt> value can be used like an object, except that attempting to call a method or get (or set) a field of <tt>null</tt> produces a run-time error. The typechecker should ensure that <tt>null</tt> is never used like a number. The typechecker can reject expressions when <tt>null</tt> is used directly as a method or field source, as in <tt>{get null x}</tt> or <tt>{send null m 0}</tt>, but <b><tt>null</tt> should always be allowed as a non-number method argument or non-number field value.</b> For example, if a method expects an object of some type, then the typechecker should allow <tt>null</tt> as an argument to the methods; if the method doesn’t try to access any fields or call any methods on the object, it should run without error.</td></tr><tr><td valign="top" align="right" class="mainfont"><font size="-2"><font>★★★</font></font>&nbsp;5.</td><td class="mainfont">Add imperative field assignment to the language. That is, in addition to the <tt>{get &lt;ExpI&gt; &lt;Symbol&gt;}</tt> form, add a <tt>{set &lt;ExpI&gt; &lt;Symbol&gt; &lt;ExpI&gt;}</tt> form that sets the value of the indicated field. (Hint: the value for each field in an object must be placed in a box.) Update the typechecker to ensure that the field is always available for the assignment, and to ensure that the type of the second <tt>&lt;ExpI&gt;</tt> in a <tt>set</tt> form is a subtype of the field’s type. <b>Your test suite must include a test that would fail with a functional implementation of field assignment</b> (i.e., one where assigning to a field produces a new object) and pass with an imperative implementation of update. <i>Constructing the test is the hard part.</i></td></tr><tr><td valign="top" align="right" class="mainfont"><font size="-2"><font>★</font></font>&nbsp;6.</td><td class="mainfont"><i>[Pre-reqsuites: 4 and 5]</i> Change <tt>new</tt> so that it does not accept values for the object’s fields. Instead, <tt>new</tt> creates an object with <tt>null</tt> or <tt>0</tt> (as appropriate) for each field’s value, and then the fields can later be changed through <tt>set</tt>.</td></tr><tr><td valign="top" align="right" class="mainfont"><font size="-2"><font>★★★</font></font>&nbsp;7.</td><td class="mainfont">Add Java-style object arrays to the language with the forms <tt>{newarray &lt;Type&gt; &lt;ExpI&gt; &lt;ExpI&gt;}</tt>, <tt>{arrayref &lt;ExpI&gt; &lt;ExpI&gt;}</tt>, and <tt>{arrayset &lt;ExpI&gt; &lt;ExpI&gt; &lt;ExpI&gt;}</tt>.<ul><li>In <tt>{newarray &lt;Type&gt; &lt;ExpI&gt; &lt;ExpI&gt;}</tt>, the first <tt>&lt;ExpI&gt;</tt> determines the size of the array, and the second <tt>&lt;ExpI&gt;</tt> is the initial value for every slot in the array (all the same); the whole expression is of type array-of-<tt>&lt;Type&gt;</tt>, and the type of the second <tt>&lt;ExpI&gt;</tt> must be a subtype of <tt>&lt;Type&gt;</tt>.</li><li>In <tt>{arrayref &lt;ExpI&gt; &lt;ExpI&gt;}</tt>, the first <tt>&lt;ExpI&gt;</tt> must produce an array-of-<tt>&lt;Type&gt;</tt> (for some <tt>&lt;Type&gt;</tt>), and the second <tt>&lt;ExpI&gt;</tt> must produce an index into the array; the expression is of type <tt>&lt;Type&gt;</tt>.</li><li>In <tt>{arrayset &lt;ExpI&gt; &lt;ExpI&gt; &lt;ExpI&gt;}</tt>, the first <tt>&lt;ExpI&gt;</tt> must have type array-of-<tt>&lt;Type&gt;</tt> (for some <tt>&lt;Type&gt;</tt>), the second <tt>&lt;ExpI&gt;</tt> must produce an index into the array, and the the third <tt>&lt;ExpI&gt;</tt> must have a type that is  a subtype of <tt>&lt;Type&gt;</tt> to produce a value to put into the array. The <tt>arrayset</tt> operation is imperative, and to help make that clear, the result (unlike Java) must always be <tt>0</tt>.</li></ul>Your implementation should allow any kind of value in an array, including arrays of arrays or array of numbers. <b>Your test suite must include a test that demonstrates <tt>arrayset</tt> as imperative.</b> <i>If you didn’t implement imperative field assignment, then constructing the test is one difficult part.</i></td></tr><tr><td valign="top" align="right" class="mainfont"><font size="-2"><font>★★</font></font>&nbsp;8.</td><td class="mainfont"><i>[Pre-requisite: 7]</i> As in Java, allow array-of-<tt>&lt;Type&gt;<sub>1</sub></tt> to be a subtype of array-of-<tt>&lt;Type&gt;<sub>2</sub></tt> when <tt>&lt;Type&gt;<sub>1</sub></tt> is a subtype of <tt>&lt;Type&gt;<sub>2</sub></tt>. A run-time check must be added to <tt>arrayset</tt> to ensure  that an instance of a class is not installed into an array that requires subclass instances.</td></tr><tr><td valign="top" align="right" class="mainfont"><font size="-2"><font>★★★★</font></font>&nbsp;9.</td><td class="mainfont">Add multi-argument methods, so that method arguments must be explicitly named in a method definition (along with the type for each argument), and identifiers are expressions. Also, allow fields to referenced directly, like method arguments (i.e., using the field name as an expression instead of using a <tt>get</tt> form).</td></tr><tr><td valign="top" align="right" class="mainfont"><font size="-2"><font>★★★★</font></font>&nbsp;10.</td><td class="mainfont">Add Java-style interfaces to the language. An interface is a set of method names, and it is a subinterface of an arbitrary number of other interfaces (in which case the interface includes all of the methods of its superinterfaces). A class implements any number of interfaces, and it is obliged to implement every method that is named in its implemented interfaces; the class is then a subtype of the interface. The type language is extended to include interface names in addition to class names and <tt>num</tt>.</td></tr><tr><td valign="top" align="right" class="mainfont"><font size="-2"><font>★★★★★</font></font>&nbsp;11.</td><td class="mainfont">Add Java-style overloading, where multiple methods can have the same name as long as they have different argument types. Usually, this is implemented by having the type-checker convert the input program to replace the original method names with names that describe the argument types.</td></tr><tr><td valign="top" align="right" class="mainfont"><font size="-2"><font>★★★★★</font></font>&nbsp;12.</td><td class="mainfont">Add Java-style generics, which are a form of parametric polymorphism. A generic class is parameterized with respect to a type variable, and whenever the generic class name is used, a specific type for the parameterization must be supplied. Consult a Java reference for more information; ignore Java’s support for generic methods and for using a generic type directly as a type (which is for backward compatibility only).</td></tr></tbody></table><hr><table width="100%"><tbody><tr><td align="right">Last update: Thursday, November 8th, 2018<address>mflatt@cs.utah.edu</address></td></tr></tbody></table>
</body></html>